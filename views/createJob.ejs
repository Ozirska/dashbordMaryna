<%- include('partials/header'); -%>
<h1>Create Job</h1>
<%- include('partials/header'); -%>

<h1 class="create_title">Create Job</h1>

<div class="home">
  <p class="back_dashboard"><span>&#60;</span><a href="/"> Dashboard</a></p>
</div>

<form action="/createJob" class="createJob_form">
  <label for="jobTitle">jobTitle</label>
  <input type="text" name="jobTitle" required />
  <div class="jobTitle error"></div>

  <label for="website">Website</label>
  <input type="text" name="website" required />
  <div class="website error"></div>
  <br />
  <h4>Employer's contact</h4>
  <br />

  <label for="employerName">Name</label>
  <input type="text" name="employerName" required />
  <div class="employerName error"></div>

  <label for="email">Email of contact</label>
  <input type="text" name="email" required />
  <div class="email error"></div>

  <label for="phone">Phone</label>
  <input type="text" name="phone" required />
  <div class="phone error"></div>

  <label for="address">Address</label>
  <input type="text" name="address" required />
  <div class="address error"></div>

  <label for="origin">Origin:</label>
  <select id="origin" name="origin">
    <option value="Candidature spontanée">Candidature spontanée</option>
    <option value="Job offer.">Job offer.</option>
  </select>

  <label for="status">Status</label>
  <select id="status" name="status">
    <option value="Interested">Interested</option>
    <option value="CV sent">CV sent</option>
    <option value="Negative">Negative</option>
    <option value="Interview">Interview</option>
  </select>
  <br />
  <label for="comments">Comments</label>
  <input type="text" name="comments" required />
  <div class="comments error"></div>

  <button>Save</button>
</form>

<script>
  const form = document.querySelector(".createJob_form");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    // Create a FormData object

    const formData = new FormData(form);

    formData.append("userId", "<%= user._id %>");

    formData.forEach((value, key) => {
      console.log(`${key}: ${value}`);
    });

    try {
      const res = await fetch("/createJob", {
        method: "POST",
        body: formData,
      });
      const data = await res.json();
      console.log(data);
    } catch (err) {
      console.log(err);
    }
  });
</script>
